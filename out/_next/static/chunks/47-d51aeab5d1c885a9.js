(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[47],{376:e=>{e.exports={container:"StudentProfile_container__E0UBn",mainContent:"StudentProfile_mainContent__LPAdj",loadingContainer:"StudentProfile_loadingContainer__j_Bb_",loadingContent:"StudentProfile_loadingContent__qIpU8",loadingText:"StudentProfile_loadingText__43qLp",notStudentMessage:"StudentProfile_notStudentMessage__eHqLO",header:"StudentProfile_header__WUm_D",headerContent:"StudentProfile_headerContent__Uo2FY",headerNav:"StudentProfile_headerNav__HMXBL",headerTitle:"StudentProfile_headerTitle__NcgKV",settingsButton:"StudentProfile_settingsButton__BAzpJ",settingsIcon:"StudentProfile_settingsIcon__RoRZx",profileHeader:"StudentProfile_profileHeader__FcfKD",fadeInUp:"StudentProfile_fadeInUp__aymCf",profileInfo:"StudentProfile_profileInfo__vzzrW",avatar:"StudentProfile_avatar__6_JZ9",profileDetails:"StudentProfile_profileDetails__8ay_x",profileName:"StudentProfile_profileName___rb1F",profileEmail:"StudentProfile_profileEmail__mgu_U",profileUid:"StudentProfile_profileUid__1Qr3o",gradeInfo:"StudentProfile_gradeInfo__UobRW",editForm:"StudentProfile_editForm__46pV5",editFormSection:"StudentProfile_editFormSection__p0RnH",editGrid:"StudentProfile_editGrid__PHSsr",inputGroup:"StudentProfile_inputGroup__ekcnD",inputLabel:"StudentProfile_inputLabel__WEuYk",editInput:"StudentProfile_editInput__FxwRn",selectInput:"StudentProfile_selectInput__tpWsi",textareaInput:"StudentProfile_textareaInput__3MqHL",disabledInput:"StudentProfile_disabledInput__8G_ag",inputHelp:"StudentProfile_inputHelp__8KZ4j",buttonGroup:"StudentProfile_buttonGroup__wgN_i",saveButton:"StudentProfile_saveButton__D1uR6",cancelButton:"StudentProfile_cancelButton__8aNRY",statsGrid:"StudentProfile_statsGrid__Qnxk4",statCard:"StudentProfile_statCard__koojX",fadeInScale:"StudentProfile_fadeInScale__BJpLW",statContent:"StudentProfile_statContent__fI2dM",statIcon:"StudentProfile_statIcon__T1B0m",statIconBlue:"StudentProfile_statIconBlue__OKWE3",statIconGreen:"StudentProfile_statIconGreen__IInTg",statIconPurple:"StudentProfile_statIconPurple__i_eRG",statIconOrange:"StudentProfile_statIconOrange__GM2l_",iconSize:"StudentProfile_iconSize__vqVec",statValue:"StudentProfile_statValue__KfLUv",statLabel:"StudentProfile_statLabel__FEk9_",weeklySection:"StudentProfile_weeklySection__wpW7N",sectionTitle:"StudentProfile_sectionTitle__zSNxk",weeklyStats:"StudentProfile_weeklyStats__GapaY",weeklyStatItem:"StudentProfile_weeklyStatItem__oOTcN",weeklyIcon:"StudentProfile_weeklyIcon__kdkc_",weeklyLabel:"StudentProfile_weeklyLabel__X_SPj",weeklyValue:"StudentProfile_weeklyValue__9Tqne",microsoftSection:"StudentProfile_microsoftSection__MEfSo",microsoftConnection:"StudentProfile_microsoftConnection__04TMi",microsoftContent:"StudentProfile_microsoftContent__bw8FR",microsoftIconContainer:"StudentProfile_microsoftIconContainer__pyJb2",microsoftLogo:"StudentProfile_microsoftLogo__dNYbM",microsoftIcon:"StudentProfile_microsoftIcon__JJf5x",microsoftText:"StudentProfile_microsoftText__QQ1o8",microsoftTitle:"StudentProfile_microsoftTitle__XAE2E",connectionStatus:"StudentProfile_connectionStatus__i1N3L",connectedStatus:"StudentProfile_connectedStatus__UGatW",disconnectedStatus:"StudentProfile_disconnectedStatus___CYsI",checkIcon:"StudentProfile_checkIcon__YZqHe",connectedText:"StudentProfile_connectedText__XVOdk",disconnectedText:"StudentProfile_disconnectedText__iKMOt",userInfo:"StudentProfile_userInfo__EnyAB",userName:"StudentProfile_userName__6BVHJ",userEmail:"StudentProfile_userEmail__jsroy",statusDescription:"StudentProfile_statusDescription__UojDV",microsoftActions:"StudentProfile_microsoftActions__ldrE8",connectButton:"StudentProfile_connectButton__bT85N",disconnectButton:"StudentProfile_disconnectButton__XAK4L",buttonLoading:"StudentProfile_buttonLoading__8XdAB",buttonSpinner:"StudentProfile_buttonSpinner__WO5Y_",spin:"StudentProfile_spin__qLNSd",infoSection:"StudentProfile_infoSection___Yyot",infoIcon:"StudentProfile_infoIcon__820iD",infoIconSvg:"StudentProfile_infoIconSvg__sBh7n",infoText:"StudentProfile_infoText__uI6rR",errorMessage:"StudentProfile_errorMessage__8fPXp",errorText:"StudentProfile_errorText__lt14p",achievementsSection:"StudentProfile_achievementsSection__p8MPo",achievementsGrid:"StudentProfile_achievementsGrid__Tb88l",achievement:"StudentProfile_achievement__DND3N",bounceIn:"StudentProfile_bounceIn__GFeyV",achievementIcon:"StudentProfile_achievementIcon__PmIAF",dashboardSelection:"StudentProfile_dashboardSelection__qlo6S",dashboardTitle:"StudentProfile_dashboardTitle__fh__a",dashboardDropdownContainer:"StudentProfile_dashboardDropdownContainer___78W6",selectedInfo:"StudentProfile_selectedInfo__Q4FSl",selectedText:"StudentProfile_selectedText__DdMPT",selectedDashboard:"StudentProfile_selectedDashboard__tTsyI",dropdown:"StudentProfile_dropdown__H6W0G",dropdownButton:"StudentProfile_dropdownButton__9sQYX",dropdownText:"StudentProfile_dropdownText__Cvz9m",chevron:"StudentProfile_chevron__G0Yyj",chevronOpen:"StudentProfile_chevronOpen__Im7vD",dropdownMenu:"StudentProfile_dropdownMenu__wYf9f",dropdownSlide:"StudentProfile_dropdownSlide__1t1zN",dropdownOption:"StudentProfile_dropdownOption__7BQuz",contentGrid:"StudentProfile_contentGrid__Sobef",infoBox:"StudentProfile_infoBox__XVEOv",infoBoxGradient1:"StudentProfile_infoBoxGradient1__3iM2d",infoBoxGradient2:"StudentProfile_infoBoxGradient2__xpZuq",infoBoxGradient3:"StudentProfile_infoBoxGradient3__7a0NZ",infoBoxGradient4:"StudentProfile_infoBoxGradient4__rL4iu",infoBoxGradient5:"StudentProfile_infoBoxGradient5__ouWa8",infoBoxTitle:"StudentProfile_infoBoxTitle__jXYCt",infoBoxContent:"StudentProfile_infoBoxContent__17TRQ",quickActions:"StudentProfile_quickActions__NzT93",quickActionsTitle:"StudentProfile_quickActionsTitle__X9JSo",actionsGrid:"StudentProfile_actionsGrid__3aCpR",actionCard:"StudentProfile_actionCard__qISZD",actionIcon:"StudentProfile_actionIcon__1oaRn",actionTitle:"StudentProfile_actionTitle__GlhKm",actionDescription:"StudentProfile_actionDescription__oVO7G",loadingSpinner:"StudentProfile_loadingSpinner__yT61O"}},2538:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var s=n(6083),o=n(6362),a=n(9999),i=n(4232);let r=()=>{let{user:e,userType:t,studentProfile:n}=(0,a.ur)(),r="student"===t&&e&&n?n.userId:"",l=(0,i.useCallback)(async e=>{if(!e)return console.log("No studentId provided to fetchStudent"),null;try{let t=(0,s.H9)(o.db,"students",e),n=await (0,s.x7)(t);if(!n.exists())return null;return{...n.data(),studentId:n.id}}catch(e){return console.error("Error fetching student:",e),null}},[]),c=(0,i.useCallback)(async e=>{if(!e)return console.log("No studentId provided to fetchStudentBookings"),[];try{let t=(0,s.P)((0,s.rJ)(o.db,"bookings"),(0,s._M)("studentId","==",e),(0,s.My)("date.year","desc"),(0,s.My)("date.month","desc"),(0,s.My)("date.day","desc"));return(await (0,s.GG)(t)).docs.map(e=>({...e.data(),bookingId:e.id}))}catch(e){return console.error("Error fetching bookings:",e),[]}},[]),d=(0,i.useCallback)(async e=>{if(!e)return console.log("No studentId provided to fetchStudentLessons"),[];try{let t=await c(e);if(!t.length)return[];let n=t.map(e=>e.bookingId),a=[];for(let e=0;e<n.length;e+=10){let t=n.slice(e,e+10),i=(0,s.P)((0,s.rJ)(o.db,"lessons"),(0,s._M)("bookingId","in",t));(await (0,s.GG)(i)).forEach(e=>a.push({...e.data(),lessonId:e.id}))}return a.sort((e,t)=>{let n=new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour,e.date.minute);return new Date(t.date.year,t.date.month-1,t.date.day,t.date.hour,t.date.minute).getTime()-n.getTime()})}catch(e){return console.error("Error fetching lessons:",e),[]}},[c]),u=(0,i.useCallback)(async e=>{if(!e)return console.log("No studentId provided to calculateStudentStats"),{totalLessons:0,completedAssignments:0,currentSubjects:0,averageGrade:0,upcomingLessons:0};try{let[t,n,s]=await Promise.all([l(e),d(e),c(e)]);if(!t)return console.log("Student not found for stats calculation"),{totalLessons:0,completedAssignments:0,currentSubjects:0,averageGrade:0,upcomingLessons:0};let o=n.filter(e=>"completed"===e.lessonStatus),a=s.filter(e=>new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour,e.date.minute)>new Date&&e.confirmed),i=t.subjects.reduce((e,t)=>e+t.currentMark,0),r=t.subjects.length>0?Math.round(i/t.subjects.length):0;return{totalLessons:o.length,completedAssignments:o.length,currentSubjects:t.subjects.length,averageGrade:r,upcomingLessons:a.length}}catch(e){return console.error("Error calculating student stats:",e),{totalLessons:0,completedAssignments:0,currentSubjects:0,averageGrade:0,upcomingLessons:0}}},[l,d,c]),m=(0,i.useCallback)(async e=>{if(!e)return console.log("No studentId provided to calculateWeeklyStats"),{weeklyLessons:0,weeklyHours:0,weeklyProgress:0,completedThisWeek:0};try{let[t,n]=await Promise.all([d(e),c(e)]),s=new Date,o=new Date(s);o.setDate(s.getDate()-s.getDay()),o.setHours(0,0,0,0);let a=new Date(o);a.setDate(o.getDate()+6),a.setHours(23,59,59,999);let i=t.filter(e=>{let t=new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour,e.date.minute);return t>=o&&t<=a}),r=n.filter(e=>{let t=new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour,e.date.minute);return t>=o&&t<=a}),l=i.filter(e=>"completed"===e.lessonStatus).length,u=r.reduce((e,t)=>e+(t.durationMinutes||60)/60,0),m=r.length,h=m>0?Math.round(l/m*100):0;return{weeklyLessons:r.length,weeklyHours:u,weeklyProgress:h,completedThisWeek:l}}catch(e){return console.error("Error calculating weekly stats:",e),{weeklyLessons:0,weeklyHours:0,weeklyProgress:0,completedThisWeek:0}}},[d,c]),h=(0,i.useCallback)(async e=>{if(!e)return console.log("No studentId provided to getSubjectPerformance"),[];try{let[t,n,a]=await Promise.all([l(e),d(e),c(e)]);if(!t||!t.subjects||!Array.isArray(t.subjects))return console.log("No student or subjects found"),[];return(await Promise.all(t.subjects.map(async e=>{let t,i,r=0,l=100;if("string"==typeof e)t=e;else{if("object"!=typeof e||null===e)return console.warn("Unexpected subject format:",e),null;if(t=e.subjectName||"Unknown Subject","currentMark"in e){let t=e.currentMark;r="number"==typeof t?t:"string"==typeof t&&parseFloat(t)||0}if("targetMark"in e){let t=e.targetMark;l="number"==typeof t?t:"string"==typeof t&&parseFloat(t)||100}i=e.tutorId||void 0}let c=n.filter(e=>{var n;let s=a.find(t=>t.bookingId===e.bookingId);return(null==s||null==(n=s.subject)?void 0:n.toLowerCase())===t.toLowerCase()&&"completed"===e.lessonStatus}),d=new Date,u=a.filter(e=>{var n;return new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour||0,e.date.minute||0)>d&&(null==(n=e.subject)?void 0:n.toLowerCase())===t.toLowerCase()&&e.confirmed}).sort((e,t)=>{let n=new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour||0,e.date.minute||0),s=new Date(t.date.year,t.date.month-1,t.date.day,t.date.hour||0,t.date.minute||0);return n.getTime()-s.getTime()}),m=u[0]?new Date(u[0].date.year,u[0].date.month-1,u[0].date.day,u[0].date.hour||0,u[0].date.minute||0):void 0,h="No Tutor Assigned";if(i&&"string"==typeof i&&""!==i.trim())try{if(/^[a-zA-Z0-9_-]+$/.test(i.trim())){let e=await (0,s.x7)((0,s.H9)(o.db,"tutors",i.trim()));if(e.exists()){let t=e.data();h=(null==t?void 0:t.username)||(null==t?void 0:t.displayName)||(null==t?void 0:t.name)||"Unknown Tutor"}else{let e=await (0,s.x7)((0,s.H9)(o.db,"users",i.trim()));if(e.exists()){let t=e.data();h=(null==t?void 0:t.displayName)||(null==t?void 0:t.username)||"Unknown Tutor"}else console.log("Tutor not found for ID: ".concat(i)),h="Tutor Not Found"}}else console.warn("Invalid tutor ID format: ".concat(i)),h="Invalid Tutor ID"}catch(e){console.error("Error fetching tutor data for ID ".concat(i,":"),e),h="permission-denied"===e.code?"Access Denied":"Error Loading Tutor"}let f=l>0?Math.min(Math.round(r/l*100),100):0;return{subjectName:t,currentMark:r,targetMark:l,progress:f,tutorName:h,lessonsCompleted:c.length,nextLessonDate:m}}))).filter(e=>null!==e)}catch(e){return console.error("Error fetching subject performance:",e),[]}},[l,d,c]),f=(0,i.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(!e)return console.log("No studentId provided to getRecentActivity"),[];try{let[n,s]=await Promise.all([d(e),c(e)]),o=[];return n.filter(e=>"completed"===e.lessonStatus).slice(0,5).forEach(e=>{let t=s.find(t=>t.bookingId===e.bookingId);o.push({id:e.lessonId,type:"lesson_completed",title:"Lesson Completed",description:"Completed ".concat((null==t?void 0:t.subject)||"Unknown"," lesson"),date:new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour,e.date.minute),subjectName:null==t?void 0:t.subject})}),s.filter(e=>new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour,e.date.minute)>new Date&&e.confirmed).slice(0,3).forEach(e=>{o.push({id:e.bookingId,type:"lesson_scheduled",title:"Lesson Scheduled",description:"Upcoming ".concat(e.subject," lesson"),date:new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour,e.date.minute),subjectName:e.subject})}),o.sort((e,t)=>t.date.getTime()-e.date.getTime()).slice(0,t)}catch(e){return console.error("Error fetching recent activity:",e),[]}},[d,c]),_=(0,i.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(!e)return console.log("No studentId provided to getUpcomingLessons"),[];try{let n=(await c(e)).filter(e=>new Date(e.date.year,e.date.month-1,e.date.day,e.date.hour,e.date.minute)>new Date&&e.confirmed).slice(0,t);return await Promise.all(n.map(async e=>{let t="Unknown Tutor";try{let n=await (0,s.x7)((0,s.H9)(o.db,"tutors",e.tutorId));n.exists()&&(t=n.data().username||"Unknown Tutor")}catch(e){console.error("Error fetching tutor data:",e)}return{...e,tutorName:t}}))}catch(e){return console.error("Error fetching upcoming lessons:",e),[]}},[c]);return{studentId:r,fetchStudent:l,fetchStudentBookings:c,fetchStudentLessons:d,calculateStudentStats:u,calculateWeeklyStats:m,getSubjectPerformance:h,getRecentActivity:f,getUpcomingLessons:_}}},9047:(e,t,n)=>{"use strict";n.r(t),n.d(t,{StudentProfile:()=>I,default:()=>k});var s=n(7876),o=n(4232),a=n(822),i=n(3569),r=n(3654),l=n(9518),c=n(5952),d=n(1449),u=n(8186),m=n(2671),h=n(6153),f=n(710),_=n(6124),p=n(376),x=n.n(p),j=n(9999),g=n(2538);let v=["Overview","Subjects","Progress","Upcoming Lessons","Past Lessons","Achievements","Recent Activity"],S=e=>{let{label:t,options:n,selected:i,onChange:r}=e,[l,c]=(0,o.useState)(!1);return(0,s.jsxs)("div",{className:x().dropdown,children:[(0,s.jsxs)("button",{onClick:()=>c(!l),className:x().dropdownButton,children:[(0,s.jsx)("span",{className:x().dropdownText,children:i}),(0,s.jsx)(a.A,{className:"".concat(x().chevron," ").concat(l?x().chevronOpen:"")})]}),l&&(0,s.jsx)("div",{className:x().dropdownMenu,children:n.map(e=>(0,s.jsx)("button",{onClick:()=>{r(e),c(!1)},className:x().dropdownOption,children:e},e))})]})},N=()=>{let{userProfile:e,linkMicrosoftToAccount:t,updateUserProfile:n,error:a,clearError:r}=(0,j.ur)(),[l,c]=(0,o.useState)({isConnected:!1,userInfo:null,loading:!0,error:null}),[d,u]=(0,o.useState)(!1);o.useEffect(()=>{m()},[e]);let m=()=>{if(!e)return void c({isConnected:!1,loading:!1,userInfo:null,error:null});let t=e.microsoftAuth;(null==t?void 0:t.accessToken)&&(null==t?void 0:t.userInfo)?c({isConnected:!0,userInfo:t.userInfo,loading:!1,error:null}):c({isConnected:!1,loading:!1,userInfo:null,error:null})},h=async()=>{u(!0),r();try{await t()}catch(e){console.error("Error linking Microsoft account:",e),c(e=>({...e,error:"Failed to connect Microsoft account"}))}finally{u(!1)}},f=async()=>{if(confirm("Are you sure you want to disconnect your Microsoft account?"))try{u(!0),await n({microsoftAuth:null}),c({isConnected:!1,loading:!1,userInfo:null,error:null})}catch(e){console.error("Error disconnecting Microsoft account:",e),c(e=>({...e,error:"Failed to disconnect Microsoft account"}))}finally{u(!1)}};return l.loading?(0,s.jsx)("div",{className:x().microsoftConnection,children:(0,s.jsxs)("div",{className:x().microsoftContent,children:[(0,s.jsx)("div",{className:x().microsoftIcon,children:(0,s.jsx)("div",{className:x().loadingSpinner})}),(0,s.jsx)("div",{className:x().microsoftText,children:(0,s.jsx)("span",{className:x().loadingText,children:"Checking Microsoft account status..."})})]})}):(0,s.jsxs)("div",{className:x().microsoftConnection,children:[(a||l.error)&&(0,s.jsx)("div",{className:x().errorMessage,children:(0,s.jsx)("p",{className:x().errorText,children:a||l.error})}),(0,s.jsxs)("div",{className:x().microsoftContent,children:[(0,s.jsx)("div",{className:x().microsoftIconContainer,children:(0,s.jsxs)("svg",{className:x().microsoftLogo,viewBox:"0 0 23 23",fill:"none",children:[(0,s.jsx)("path",{d:"M0 0h11v11H0z",fill:"#f25022"}),(0,s.jsx)("path",{d:"M12 0h11v11H12z",fill:"#7fba00"}),(0,s.jsx)("path",{d:"M0 12h11v11H0z",fill:"#00a4ef"}),(0,s.jsx)("path",{d:"M12 12h11v11H12z",fill:"#ffb900"})]})}),(0,s.jsxs)("div",{className:x().microsoftText,children:[(0,s.jsx)("h3",{className:x().microsoftTitle,children:"Microsoft Account"}),l.isConnected?(0,s.jsxs)("div",{className:x().connectionStatus,children:[(0,s.jsxs)("div",{className:x().connectedStatus,children:[(0,s.jsx)(i.A,{className:x().checkIcon}),(0,s.jsx)("span",{className:x().connectedText,children:"Connected"})]}),l.userInfo&&(0,s.jsxs)("div",{className:x().userInfo,children:[(0,s.jsx)("p",{className:x().userName,children:l.userInfo.displayName}),(0,s.jsx)("p",{className:x().userEmail,children:l.userInfo.mail||l.userInfo.userPrincipalName})]}),(0,s.jsx)("p",{className:x().statusDescription,children:"Access your OneDrive files and join Teams meetings seamlessly"})]}):(0,s.jsxs)("div",{className:x().connectionStatus,children:[(0,s.jsx)("div",{className:x().disconnectedStatus,children:(0,s.jsx)("span",{className:x().disconnectedText,children:"⚠ Not connected"})}),(0,s.jsx)("p",{className:x().statusDescription,children:"Connect to access OneDrive files and join Teams meetings for your tutoring sessions"})]})]}),(0,s.jsx)("div",{className:x().microsoftActions,children:l.isConnected?(0,s.jsx)("button",{onClick:f,disabled:d,className:x().disconnectButton,children:d?(0,s.jsxs)("div",{className:x().buttonLoading,children:[(0,s.jsx)("div",{className:x().buttonSpinner}),(0,s.jsx)("span",{children:"Disconnecting..."})]}):"Disconnect"}):(0,s.jsx)("button",{onClick:h,disabled:d,className:x().connectButton,children:d?(0,s.jsxs)("div",{className:x().buttonLoading,children:[(0,s.jsx)("div",{className:x().buttonSpinner}),(0,s.jsx)("span",{children:"Connecting..."})]}):"Connect Account"})})]}),(null==e?void 0:e.userType)==="student"&&(0,s.jsxs)("div",{className:x().infoSection,children:[(0,s.jsx)("div",{className:x().infoIcon,children:(0,s.jsx)("svg",{className:x().infoIconSvg,fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,s.jsx)("p",{className:x().infoText,children:"Connecting your Microsoft account enhances your learning experience with direct access to course materials and seamless video calls."})]})]})},y=e=>{let{icon:t,label:n,value:o,color:a="blue",loading:i=!1}=e;return(0,s.jsx)("div",{className:x().statCard,children:(0,s.jsxs)("div",{className:x().statContent,children:[(0,s.jsx)("div",{className:"".concat(x().statIcon," ").concat(x()["statIcon".concat(a.charAt(0).toUpperCase()+a.slice(1))]),children:(0,s.jsx)(t,{className:x().iconSize})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:x().statValue,children:i?"...":o}),(0,s.jsx)("p",{className:x().statLabel,children:n})]})]})})},b=e=>{let{title:t,content:n,index:o}=e;return(0,s.jsxs)("div",{className:"".concat(x().infoBox," ").concat(x()["infoBoxGradient".concat(o%5+1)]),children:[(0,s.jsx)("h4",{className:x().infoBoxTitle,children:t}),(0,s.jsx)("p",{className:x().infoBoxContent,children:n})]})},P=e=>{let{subject:t}=e;return(0,s.jsxs)("div",{className:x().subjectCard,children:[(0,s.jsxs)("div",{className:x().subjectHeader,children:[(0,s.jsx)("h4",{className:x().subjectName,children:t.subjectName}),(0,s.jsxs)("span",{className:x().subjectProgress,children:[t.progress,"%"]})]}),(0,s.jsxs)("div",{className:x().subjectDetails,children:[(0,s.jsxs)("p",{className:x().subjectMark,children:["Current: ",t.currentMark,"% | Target: ",t.targetMark,"%"]}),(0,s.jsxs)("p",{className:x().subjectTutor,children:["Tutor: ",t.tutorName]}),(0,s.jsxs)("p",{className:x().subjectLessons,children:["Lessons Completed: ",t.lessonsCompleted]}),t.nextLessonDate&&(0,s.jsxs)("p",{className:x().nextLesson,children:["Next Lesson: ",t.nextLessonDate.toLocaleDateString()]})]}),(0,s.jsx)("div",{className:x().progressBar,children:(0,s.jsx)("div",{className:x().progressFill,style:{width:"".concat(Math.min(t.progress,100),"%")}})})]})},w=e=>{let{activity:t}=e;return(0,s.jsxs)("div",{className:x().activityItem,children:[(()=>{switch(t.type){case"lesson_completed":return(0,s.jsx)(i.A,{className:x().activityIcon,style:{color:"#10b981"}});case"lesson_scheduled":return(0,s.jsx)(r.A,{className:x().activityIcon,style:{color:"#3b82f6"}});case"grade_updated":return(0,s.jsx)(l.A,{className:x().activityIcon,style:{color:"#8b5cf6"}});default:return(0,s.jsx)(c.A,{className:x().activityIcon})}})(),(0,s.jsxs)("div",{className:x().activityContent,children:[(0,s.jsx)("h5",{className:x().activityTitle,children:t.title}),(0,s.jsx)("p",{className:x().activityDescription,children:t.description}),(0,s.jsx)("p",{className:x().activityDate,children:t.date.toLocaleDateString()})]})]})},I=()=>{var e;let[t,n]=(0,o.useState)(v[0]),{user:a,userProfile:p,studentProfile:I,userType:k,updateUserProfile:C,updateStudentProfile:T,isLoading:L}=(0,j.ur)(),A=(0,g.j)(),[D,G]=(0,o.useState)(""),[M,B]=(0,o.useState)(""),[E,H]=(0,o.useState)(""),[U,F]=(0,o.useState)(""),[W,R]=(0,o.useState)(!1),[Y,O]=(0,o.useState)({totalLessons:0,completedAssignments:0,currentSubjects:0,averageGrade:0,upcomingLessons:0}),[z,V]=(0,o.useState)({weeklyLessons:0,weeklyHours:0,weeklyProgress:0,completedThisWeek:0}),[q,X]=(0,o.useState)([]),[J,Q]=(0,o.useState)([]),[K,Z]=(0,o.useState)([]),[$,ee]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{if(p&&I){var e,t,n;G(p.displayName||""),B((null==(e=I.grade)?void 0:e.toString())||""),H((null==(t=I.subjects)?void 0:t.join(", "))||""),F((null==(n=I.enrolledCourses)?void 0:n.join(", "))||"")}},[p,I]),(0,o.useEffect)(()=>{(async()=>{if(!(null==A?void 0:A.studentId))return console.log("No studentId available yet");if($)return console.log("Already loading stats, skipping...");ee(!0);try{let[e,t,n,s,o]=await Promise.all([A.calculateStudentStats(A.studentId),A.calculateWeeklyStats(A.studentId),A.getSubjectPerformance(A.studentId),A.getRecentActivity(A.studentId,10),A.getUpcomingLessons(A.studentId,5)]);O(e),V(t),X(n),Q(s),Z(o)}catch(e){console.error("Error loading student data:",e)}finally{ee(!1)}})()},[null==A?void 0:A.studentId]),"student"!==k||!a||!p||!I||!A)return(0,s.jsx)("div",{className:x().notStudentMessage,children:"Not a Student or profile not loaded."});let et=async()=>{try{await C({displayName:D}),await T({grade:M?parseInt(M):void 0,subjects:E.split(",").map(e=>e.trim()).filter(e=>e),enrolledCourses:U.split(",").map(e=>e.trim()).filter(e=>e)}),R(!1),alert("Profile updated successfully!")}catch(e){console.error("Error updating profile:",e),alert("Failed to update profile. Please try again.")}};if("student"!==k||!a||!p||!I||!(null==A?void 0:A.studentId))return L?(0,s.jsx)("div",{className:x().loadingContainer,children:(0,s.jsxs)("div",{className:x().loadingContent,children:[(0,s.jsx)("div",{className:x().loadingSpinner}),(0,s.jsx)("p",{className:x().loadingText,children:"Loading your profile..."})]})}):(0,s.jsx)("div",{className:x().notStudentMessage,children:"Not a Student or profile not loaded."});let en=e=>{if(0===e)return"0";if(e<1)return"".concat(Math.round(60*e),"m");let t=Math.floor(e),n=Math.round((e-t)*60);return 0===n?"".concat(t,"h"):"".concat(t,"h ").concat(n,"m")};return L?(0,s.jsx)("div",{className:x().loadingContainer,children:(0,s.jsxs)("div",{className:x().loadingContent,children:[(0,s.jsx)("div",{className:x().loadingSpinner}),(0,s.jsx)("p",{className:x().loadingText,children:"Loading your profile..."})]})}):(0,s.jsxs)("div",{className:x().container,children:[(0,s.jsx)("div",{className:x().header,children:(0,s.jsx)("div",{className:x().headerContent,children:(0,s.jsxs)("div",{className:x().headerNav,children:[(0,s.jsx)("h1",{className:x().headerTitle,children:"Student Profile & Dashboard"}),(0,s.jsx)("button",{onClick:()=>R(!W),className:x().settingsButton,children:(0,s.jsx)(d.A,{className:x().settingsIcon})})]})})}),(0,s.jsxs)("div",{className:x().mainContent,children:[(0,s.jsxs)("div",{className:x().profileHeader,children:[(0,s.jsxs)("div",{className:x().profileInfo,children:[(0,s.jsx)("div",{className:x().avatar,children:(null==(e=p.displayName)?void 0:e.split(" ").map(e=>e[0]).join(""))||"S"}),(0,s.jsx)("div",{className:x().profileDetails,children:W?(0,s.jsxs)("div",{className:x().editForm,children:[(0,s.jsx)("input",{type:"text",value:D,onChange:e=>G(e.target.value),className:x().editInput,placeholder:"Display Name"}),(0,s.jsx)("p",{className:x().profileEmail,children:p.email}),(0,s.jsxs)("p",{className:x().profileUid,children:["UID: ",p.uid]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:x().profileName,children:p.displayName||"Student"}),(0,s.jsx)("p",{className:x().profileEmail,children:p.email}),(0,s.jsxs)("p",{className:x().profileUid,children:["UID: ",p.uid]}),I.grade&&(0,s.jsxs)("p",{className:x().gradeInfo,children:["Grade ",I.grade]})]})})]}),W&&(0,s.jsxs)("div",{className:x().editFormSection,children:[(0,s.jsxs)("div",{className:x().editGrid,children:[(0,s.jsxs)("div",{className:x().inputGroup,children:[(0,s.jsx)("label",{className:x().inputLabel,children:"Email"}),(0,s.jsx)("input",{type:"email",value:p.email,disabled:!0,className:x().disabledInput}),(0,s.jsx)("p",{className:x().inputHelp,children:"Email cannot be changed"})]}),(0,s.jsxs)("div",{className:x().inputGroup,children:[(0,s.jsx)("label",{className:x().inputLabel,children:"Grade"}),(0,s.jsxs)("select",{value:M,onChange:e=>B(e.target.value),className:x().selectInput,children:[(0,s.jsx)("option",{value:"",children:"Select Grade"}),Array.from({length:12},(e,t)=>t+1).map(e=>(0,s.jsxs)("option",{value:e.toString(),children:["Grade ",e]},e))]})]})]}),(0,s.jsxs)("div",{className:x().inputGroup,children:[(0,s.jsx)("label",{className:x().inputLabel,children:"Subjects"}),(0,s.jsx)("textarea",{value:E,onChange:e=>H(e.target.value),rows:3,placeholder:"Enter subjects separated by commas (e.g., Mathematics, English, Science)",className:x().textareaInput})]}),(0,s.jsxs)("div",{className:x().inputGroup,children:[(0,s.jsx)("label",{className:x().inputLabel,children:"Enrolled Courses"}),(0,s.jsx)("textarea",{value:U,onChange:e=>F(e.target.value),rows:2,placeholder:"Enter enrolled courses separated by commas",className:x().textareaInput})]}),(0,s.jsxs)("div",{className:x().buttonGroup,children:[(0,s.jsx)("button",{onClick:et,disabled:L,className:x().saveButton,children:L?"Saving...":"Save Changes"}),(0,s.jsx)("button",{onClick:()=>{var e,t,n;G(p.displayName||""),B((null==(e=I.grade)?void 0:e.toString())||""),H((null==(t=I.subjects)?void 0:t.join(", "))||""),F((null==(n=I.enrolledCourses)?void 0:n.join(", "))||""),R(!1)},className:x().cancelButton,children:"Cancel"})]})]}),!W&&(0,s.jsxs)("div",{className:x().statsGrid,children:[(0,s.jsx)(y,{icon:c.A,label:"Total Lessons",value:Y.totalLessons,color:"blue",loading:$}),(0,s.jsx)(y,{icon:u.A,label:"Completed Assignments",value:Y.completedAssignments,color:"green",loading:$}),(0,s.jsx)(y,{icon:m.A,label:"Active Subjects",value:Y.currentSubjects,color:"purple",loading:$}),(0,s.jsx)(y,{icon:h.A,label:"Average Grade",value:"".concat(Y.averageGrade,"%"),color:"orange",loading:$}),(0,s.jsx)(y,{icon:r.A,label:"Upcoming Lessons",value:Y.upcomingLessons,color:"indigo",loading:$})]})]}),!W&&(0,s.jsxs)("div",{className:x().weeklySection,children:[(0,s.jsx)("h3",{className:x().sectionTitle,children:"This Week's Progress"}),(0,s.jsxs)("div",{className:x().weeklyStats,children:[(0,s.jsxs)("div",{className:x().weeklyStatItem,children:[(0,s.jsx)(r.A,{className:x().weeklyIcon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:x().weeklyLabel,children:"Weekly Lessons"}),(0,s.jsx)("p",{className:x().weeklyValue,children:$?"...":z.weeklyLessons})]})]}),(0,s.jsxs)("div",{className:x().weeklyStatItem,children:[(0,s.jsx)(f.A,{className:x().weeklyIcon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:x().weeklyLabel,children:"Study Hours"}),(0,s.jsx)("p",{className:x().weeklyValue,children:$?"...":en(z.weeklyHours)})]})]}),(0,s.jsxs)("div",{className:x().weeklyStatItem,children:[(0,s.jsx)(l.A,{className:x().weeklyIcon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:x().weeklyLabel,children:"Progress Score"}),(0,s.jsx)("p",{className:x().weeklyValue,children:$?"...":"".concat(z.weeklyProgress,"%")})]})]}),(0,s.jsxs)("div",{className:x().weeklyStatItem,children:[(0,s.jsx)(i.A,{className:x().weeklyIcon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:x().weeklyLabel,children:"Completed This Week"}),(0,s.jsx)("p",{className:x().weeklyValue,children:$?"...":z.completedThisWeek})]})]})]})]}),!W&&(0,s.jsx)("div",{className:x().microsoftSection,children:(0,s.jsx)(N,{})}),!W&&(0,s.jsxs)("div",{className:x().achievementsSection,children:[(0,s.jsx)("h3",{className:x().sectionTitle,children:"Achievements"}),(0,s.jsxs)("div",{className:x().achievementsGrid,children:[Y.totalLessons>=10&&(0,s.jsxs)("div",{className:x().achievement,children:[(0,s.jsx)(_.A,{className:x().achievementIcon,style:{color:"#fbbf24"}}),(0,s.jsx)("span",{children:"10+ Lessons"})]}),Y.completedAssignments>=15&&(0,s.jsxs)("div",{className:x().achievement,children:[(0,s.jsx)(u.A,{className:x().achievementIcon,style:{color:"#10b981"}}),(0,s.jsx)("span",{children:"Assignment Star"})]}),Y.averageGrade>=80&&(0,s.jsxs)("div",{className:x().achievement,children:[(0,s.jsx)(h.A,{className:x().achievementIcon,style:{color:"#8b5cf6"}}),(0,s.jsx)("span",{children:"Honor Roll"})]}),z.weeklyProgress>=75&&(0,s.jsxs)("div",{className:x().achievement,children:[(0,s.jsx)(l.A,{className:x().achievementIcon,style:{color:"#60a5fa"}}),(0,s.jsx)("span",{children:"Progress Pro"})]}),Y.currentSubjects>=5&&(0,s.jsxs)("div",{className:x().achievement,children:[(0,s.jsx)(c.A,{className:x().achievementIcon,style:{color:"#f97316"}}),(0,s.jsx)("span",{children:"Multi-Subject"})]})]})]}),!W&&(0,s.jsxs)("div",{className:x().dashboardSelection,children:[(0,s.jsx)("h3",{className:x().dashboardTitle,children:"View Dashboard"}),(0,s.jsxs)("div",{className:x().dashboardDropdownContainer,children:[(0,s.jsx)(S,{label:"Select view",options:v,selected:t,onChange:n}),(0,s.jsx)("div",{className:x().selectedInfo,children:(0,s.jsxs)("p",{className:x().selectedText,children:["Currently viewing: ",(0,s.jsx)("span",{className:x().selectedDashboard,children:t})]})})]})]}),!W&&(0,s.jsxs)("div",{className:x().contentGrid,children:["Overview"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{title:"Learning Journey",content:"You've completed ".concat(Y.totalLessons," lessons and are making excellent progress across ").concat(Y.currentSubjects," subjects."),index:0}),(0,s.jsx)(b,{title:"This Week",content:"You have ".concat(z.weeklyLessons," lessons scheduled and ").concat(en(z.weeklyHours)," of study time planned."),index:1}),(0,s.jsx)(b,{title:"Academic Performance",content:"Your current average grade is ".concat(Y.averageGrade,"%, showing consistent improvement in your studies."),index:2})]}),"Subjects"===t&&(0,s.jsxs)("div",{className:x().subjectsGrid,children:[q.map((e,t)=>(0,s.jsx)(P,{subject:e},t)),0===q.length&&!$&&(0,s.jsx)(b,{title:"No Subjects Found",content:"You don't have any subjects with performance data yet. Complete some lessons to see your progress here.",index:0})]}),"Progress"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{title:"Academic Growth",content:"Your average grade has improved to ".concat(Y.averageGrade,"%, showing consistent progress in your learning journey."),index:0}),(0,s.jsx)(b,{title:"Assignment Success",content:"You've completed ".concat(Y.completedAssignments," out of ").concat(Y.totalLessons," assignments, maintaining excellent consistency."),index:1}),(0,s.jsx)(b,{title:"Weekly Goals",content:"This week's progress score is ".concat(z.weeklyProgress,"%. You've completed ").concat(z.completedThisWeek," lessons this week."),index:2}),(0,s.jsx)(b,{title:"Subject Performance",content:"Currently tracking progress across ".concat(Y.currentSubjects," active subjects with personalized tutoring support."),index:3})]}),"Upcoming Lessons"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{title:"This Week",content:"You have ".concat(Y.upcomingLessons," lessons scheduled with ").concat(z.weeklyLessons," happening this week."),index:0}),(0,s.jsx)(b,{title:"Study Time",content:"Plan for ".concat(en(z.weeklyHours)," of focused learning time this week."),index:1}),(0,s.jsx)(b,{title:"Preparation Tips",content:"Make sure to review your previous lessons and prepare any questions for your upcoming sessions.",index:2}),(0,s.jsx)(b,{title:"Upcoming Schedule",content:"".concat(K.length," lessons are confirmed and scheduled in your calendar."),index:3})]}),"Past Lessons"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{title:"Total Learning",content:"You have completed ".concat(Y.totalLessons," lessons, building a strong foundation across multiple subjects."),index:0}),(0,s.jsx)(b,{title:"Consistency Record",content:"Your assignment completion rate is ".concat(Math.round(Y.completedAssignments/Math.max(Y.totalLessons,1)*100),"% showing dedicated learning habits."),index:1}),(0,s.jsx)(b,{title:"Learning History",content:"Review your past lessons, notes, and feedback to reinforce your learning and identify areas for improvement.",index:2})]}),"Achievements"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{title:"Academic Milestones",content:"Track your learning achievements and celebrate your progress as you reach new educational goals.",index:0}),(0,s.jsx)(b,{title:"Progress Tracking",content:"Based on ".concat(Y.totalLessons," completed lessons and ").concat(Y.completedAssignments," finished assignments."),index:1}),(0,s.jsx)(b,{title:"Future Goals",content:"Set new targets and work towards achieving even greater academic success in your learning journey.",index:2}),(0,s.jsx)(b,{title:"Performance Summary",content:"Currently maintaining a ".concat(Y.averageGrade,"% average across ").concat(Y.currentSubjects," subjects."),index:3})]}),"Recent Activity"===t&&(0,s.jsxs)("div",{className:x().activityGrid,children:[J.map((e,t)=>(0,s.jsx)(w,{activity:e},e.id)),0===J.length&&!$&&(0,s.jsx)(b,{title:"No Recent Activity",content:"Complete some lessons or schedule new sessions to see your recent activity here.",index:0})]})]}),!W&&(0,s.jsxs)("div",{className:x().quickActions,children:[(0,s.jsx)("h3",{className:x().quickActionsTitle,children:"Quick Actions"}),(0,s.jsxs)("div",{className:x().actionsGrid,children:[(0,s.jsxs)("button",{className:x().actionCard,children:[(0,s.jsx)(r.A,{className:x().actionIcon}),(0,s.jsx)("p",{className:x().actionTitle,children:"Book Lesson"}),(0,s.jsx)("p",{className:x().actionDescription,children:"Schedule a new tutoring session"})]}),(0,s.jsxs)("button",{className:x().actionCard,children:[(0,s.jsx)(c.A,{className:x().actionIcon}),(0,s.jsx)("p",{className:x().actionTitle,children:"Study Materials"}),(0,s.jsx)("p",{className:x().actionDescription,children:"Access your course resources"})]}),(0,s.jsxs)("button",{className:x().actionCard,children:[(0,s.jsx)(m.A,{className:x().actionIcon}),(0,s.jsx)("p",{className:x().actionTitle,children:"View Progress"}),(0,s.jsx)("p",{className:x().actionDescription,children:"Track your learning journey"})]})]})]})]})]})},k=I}}]);